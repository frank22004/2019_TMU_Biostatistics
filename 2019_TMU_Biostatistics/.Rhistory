summarise_all(
count = sum(!is.na(`day5Ratio`),na.rm = TRUE),
mean = mean(!is.na(`day5Ratio`), na.rm = TRUE),
sd = sd(!is.na(`day5Ratio`), na.rm = TRUE),
median = median(!is.na(`day5Ratio`), na.rm = TRUE),
IQR = IQR(!is.na(`day5Ratio`), na.rm = TRUE),
se = sd(!is.na(`day5Ratio`), na.rm = TRUE)/sqrt(count)
)
Day5Matrix <-   df_data[df_data$CulturedDate <=11 & df_data$SpheroidDensity <= 1000 & df_data$Condition == "Spheroid" &
#                         df_data$Status != "Contaminated"&
(df_data$Status == "CompressedWithCell" | df_data$Status == "UncompressedWithCell"),]%>%
#| df_data$Status == "20%Coat" | df_data$Status == "80%Coat",]%>%
#df_data[df_data$`Cell` == 23 | df_data$`Cell` == 25 | df_data$`Cell` == 33,] %>%
group_by(`CulturedDate`,`Condition`,`Status`,`SpheroidDensity`) %>%
summarise(
count = sum(!is.na(`day5Ratio`),na.rm = TRUE),
mean = mean(!is.na(`day5Ratio`), na.rm = TRUE),
sd = sd(!is.na(`day5Ratio`), na.rm = TRUE),
median = median(!is.na(`day5Ratio`), na.rm = TRUE),
IQR = IQR(!is.na(`day5Ratio`), na.rm = TRUE),
se = sd(!is.na(`day5Ratio`), na.rm = TRUE)/sqrt(count)
)
Day5Matrix
Day5Matrix <-   df_data[df_data$CulturedDate <=11 & df_data$SpheroidDensity <= 1000 & df_data$Condition == "Spheroid" &
#                         df_data$Status != "Contaminated"&
(df_data$Status == "CompressedWithCell" | df_data$Status == "UncompressedWithCell"),]%>%
#| df_data$Status == "20%Coat" | df_data$Status == "80%Coat",]%>%
#df_data[df_data$`Cell` == 23 | df_data$`Cell` == 25 | df_data$`Cell` == 33,] %>%
group_by(`CulturedDate`,`Condition`,`Status`,`SpheroidDensity`) %>%
summarise(
count = sum(!is.na(`day5Ratio`),na.rm = TRUE),
mean = mean(`day5Ratio`, na.rm = TRUE),
sd = sd(`day5Ratio`, na.rm = TRUE),
median = median(`day5Ratio`, na.rm = TRUE),
IQR = IQR(`day5Ratio`, na.rm = TRUE),
se = sd(`day5Ratio`, na.rm = TRUE)/sqrt(count)
)
Day5Matrix
Day5Matrix <-   df_data[df_data$CulturedDate <=11 & df_data$SpheroidDensity <= 1000 & df_data$Condition == "Spheroid" &
#                         df_data$Status != "Contaminated"&
(df_data$Status == "CompressedWithCell" | df_data$Status == "UncompressedWithCell"),]%>%
#| df_data$Status == "20%Coat" | df_data$Status == "80%Coat",]%>%
#df_data[df_data$`Cell` == 23 | df_data$`Cell` == 25 | df_data$`Cell` == 33,] %>%
group_by(`CulturedDate`,`Condition`,`Status`,`SpheroidDensity`) %>%
summarise(
count = sum(`day5Ratio`,na.rm = TRUE),
mean = mean(`day5Ratio`, na.rm = TRUE),
sd = sd(`day5Ratio`, na.rm = TRUE),
median = median(`day5Ratio`, na.rm = TRUE),
IQR = IQR(`day5Ratio`, na.rm = TRUE),
se = sd(`day5Ratio`, na.rm = TRUE)/sqrt(count)
)
Day5Matrix
Day5Matrix <-   df_data[df_data$CulturedDate <=11 & df_data$SpheroidDensity <= 1000 & df_data$Condition == "Spheroid" &
#                         df_data$Status != "Contaminated"&
(df_data$Status == "CompressedWithCell" | df_data$Status == "UncompressedWithCell"),]%>%
#| df_data$Status == "20%Coat" | df_data$Status == "80%Coat",]%>%
#df_data[df_data$`Cell` == 23 | df_data$`Cell` == 25 | df_data$`Cell` == 33,] %>%
group_by(`CulturedDate`,`Condition`,`Status`,`SpheroidDensity`) %>%
summarise(
count = sum(!is.na(`day5Ratio`),na.rm = TRUE),
mean = mean(`day5Ratio`, na.rm = TRUE),
sd = sd(`day5Ratio`, na.rm = TRUE),
median = median(`day5Ratio`, na.rm = TRUE),
IQR = IQR(`day5Ratio`, na.rm = TRUE),
se = sd(`day5Ratio`, na.rm = TRUE)/sqrt(count)
)
Day5Matrix
Day5Matrix <-   df_data[df_data$CulturedDate <=11 & df_data$SpheroidDensity <= 1000 & df_data$Condition == "Spheroid" &
#                         df_data$Status != "Contaminated"&
(df_data$Status == "CompressedWithCell" | df_data$Status == "UncompressedWithCell"),]%>%
#| df_data$Status == "20%Coat" | df_data$Status == "80%Coat",]%>%
#df_data[df_data$`Cell` == 23 | df_data$`Cell` == 25 | df_data$`Cell` == 33,] %>%
group_by(`CulturedDate`,`Condition`,`Status`,`SpheroidDensity`) %>%
summarise(
count = sum(!is.na(`day5Ratio`),na.rm = TRUE),
mean = mean(`day5Ratio`, na.rm = TRUE),
sd = sd(`day5Ratio`, na.rm = TRUE),
median = median(`day5Ratio`, na.rm = TRUE),
IQR = IQR(`day5Ratio`, na.rm = TRUE),
se = sd(`day5Ratio`, na.rm = TRUE)/sqrt(count)
)
Day5Matrix
Day5Matrix <-   df_data[df_data$CulturedDate <=11 & df_data$SpheroidDensity <= 1000 & df_data$Condition == "Spheroid" &
#                         df_data$Status != "Contaminated"&
(df_data$Status == "CompressedWithCell" | df_data$Status == "UncompressedWithCell"),]%>%
#| df_data$Status == "20%Coat" | df_data$Status == "80%Coat",]%>%
#df_data[df_data$`Cell` == 23 | df_data$`Cell` == 25 | df_data$`Cell` == 33,] %>%
group_by(`CulturedDate`,`Condition`,`Status`,`SpheroidDensity`) %>%
summarise(
count = sum(!is.na(`day5Ratio`),na.rm = TRUE),
mean = mean(`day5Ratio`, na.rm = TRUE),
sd = sd(`day5Ratio`, na.rm = TRUE),
median = median(`day5Ratio`, na.rm = TRUE),
IQR = IQR(`day5Ratio`, na.rm = TRUE),
#    se = sd(`day5Ratio`, na.rm = TRUE)/sqrt(count)
)
Day5Matrix
Day5Matrix <-   df_data[df_data$CulturedDate <=11 & df_data$SpheroidDensity <= 1000 & df_data$Condition == "Spheroid" &
#                         df_data$Status != "Contaminated"&
(df_data$Status == "CompressedWithCell" | df_data$Status == "UncompressedWithCell"),]%>%
#| df_data$Status == "20%Coat" | df_data$Status == "80%Coat",]%>%
#df_data[df_data$`Cell` == 23 | df_data$`Cell` == 25 | df_data$`Cell` == 33,] %>%
group_by(`CulturedDate`,`Condition`,`Status`,`SpheroidDensity`) %>%
summarise(
count = sum(!is.na(`day5Ratio`),na.rm = TRUE),
mean = mean(`day5Ratio`, na.rm = TRUE),
sd = sd(`day5Ratio`, na.rm = TRUE),
median = median(`day5Ratio`, na.rm = TRUE),
IQR = IQR(`day5Ratio`, na.rm = TRUE),
se = sd(`day5Ratio`, na.rm = TRUE)/sqrt(count)
)
Day5Matrix
Day5Matrix <-   df_data[df_data$CulturedDate <=11 & df_data$SpheroidDensity <= 1000 & df_data$Condition == "Spheroid" &
#                         df_data$Status != "Contaminated"&
(df_data$Status == "CompressedWithCell" | df_data$Status == "UncompressedWithCell"),]%>%
#| df_data$Status == "20%Coat" | df_data$Status == "80%Coat",]%>%
#df_data[df_data$`Cell` == 23 | df_data$`Cell` == 25 | df_data$`Cell` == 33,] %>%
group_by(`CulturedDate`,`Condition`,`Status`,`SpheroidDensity`) %>%
summarise(
#    count = sum(!is.na(`day5Ratio`),na.rm = TRUE),
mean = mean(`day5Ratio`, na.rm = TRUE),
#    sd = sd(`day5Ratio`, na.rm = TRUE),
#    median = median(`day5Ratio`, na.rm = TRUE),
#    IQR = IQR(`day5Ratio`, na.rm = TRUE),
#    se = sd(`day5Ratio`, na.rm = TRUE)/sqrt(count)
)
Day5Matrix
Day5Matrix <-   df_data[df_data$CulturedDate <=11 & df_data$SpheroidDensity <= 1000 & df_data$Condition == "Spheroid" &
#                         df_data$Status != "Contaminated"&
(df_data$Status == "CompressedWithCell" | df_data$Status == "UncompressedWithCell"),]%>%
#| df_data$Status == "20%Coat" | df_data$Status == "80%Coat",]%>%
#df_data[df_data$`Cell` == 23 | df_data$`Cell` == 25 | df_data$`Cell` == 33,] %>%
group_by(`CulturedDate`,`Condition`,`Status`,`SpheroidDensity`) %>%
summarise(
count = sum(!is.na(`day5Ratio`),na.rm = TRUE),
mean = mean(`day5Ratio`, na.rm = TRUE),
sd = sd(`day5Ratio`, na.rm = TRUE),
median = median(`day5Ratio`, na.rm = TRUE),
IQR = IQR(`day5Ratio`, na.rm = TRUE),
se = sd(`day5Ratio`, na.rm = TRUE)/sqrt(count)
)
Day5Matrix
Day5Matrix <-   df_data[df_data$CulturedDate <=11 & df_data$SpheroidDensity <= 1000 & df_data$Condition == "Spheroid" &
#                         df_data$Status != "Contaminated"&
(df_data$Status == "CompressedWithCell" | df_data$Status == "UncompressedWithCell"),]%>%
#| df_data$Status == "20%Coat" | df_data$Status == "80%Coat",]%>%
#df_data[df_data$`Cell` == 23 | df_data$`Cell` == 25 | df_data$`Cell` == 33,] %>%
group_by(`CulturedDate`,`Condition`,`Status`,`SpheroidDensity`) %>%
summarise(
count = sum(!is.na(`day5Ratio`),na.rm = TRUE),
mean = mean(`day5Ratio`),
sd = sd(`day5Ratio`, na.rm = TRUE),
median = median(`day5Ratio`, na.rm = TRUE),
IQR = IQR(`day5Ratio`, na.rm = TRUE),
se = sd(`day5Ratio`, na.rm = TRUE)/sqrt(count)
)
Day5Matrix
Day5Matrix <-   df_data[df_data$CulturedDate <=11 & df_data$SpheroidDensity <= 1000 & df_data$Condition == "Spheroid" &
#                         df_data$Status != "Contaminated"&
(df_data$Status == "CompressedWithCell" | df_data$Status == "UncompressedWithCell"),]%>%
#| df_data$Status == "20%Coat" | df_data$Status == "80%Coat",]%>%
#df_data[df_data$`Cell` == 23 | df_data$`Cell` == 25 | df_data$`Cell` == 33,] %>%
group_by(`CulturedDate`,`Condition`,`Status`,`SpheroidDensity`) %>%
summarise(
count = sum(!is.na(`day5Ratio`),na.rm = TRUE),
mean = mean(`day5Ratio`, na.rm = TRUE),
sd = sd(`day5Ratio`, na.rm = TRUE),
median = median(`day5Ratio`, na.rm = TRUE),
IQR = IQR(`day5Ratio`, na.rm = TRUE),
se = sd(`day5Ratio`, na.rm = TRUE)/sqrt(count)
)
Day5Matrix
Day5Matrix <-   df_data[df_data$CulturedDate <=11 & df_data$SpheroidDensity <= 1000 & df_data$Condition == "Spheroid" &
#                         df_data$Status != "Contaminated"&
(df_data$Status == "CompressedWithCell" | df_data$Status == "UncompressedWithCell"),]%>%
#| df_data$Status == "20%Coat" | df_data$Status == "80%Coat",]%>%
#df_data[df_data$`Cell` == 23 | df_data$`Cell` == 25 | df_data$`Cell` == 33,] %>%
group_by(`CulturedDate`,`Condition`,`Status`,`SpheroidDensity`) %>%
summarise(
count = n(!is.na(`day5Ratio`),na.rm = TRUE),
mean = mean(`day5Ratio`, na.rm = TRUE),
sd = sd(`day5Ratio`, na.rm = TRUE),
median = median(`day5Ratio`, na.rm = TRUE),
IQR = IQR(`day5Ratio`, na.rm = TRUE),
se = sd(`day5Ratio`, na.rm = TRUE)/sqrt(count)
)
Day5Matrix <-   df_data[df_data$CulturedDate <=11 & df_data$SpheroidDensity <= 1000 & df_data$Condition == "Spheroid" &
#                         df_data$Status != "Contaminated"&
(df_data$Status == "CompressedWithCell" | df_data$Status == "UncompressedWithCell"),]%>%
#| df_data$Status == "20%Coat" | df_data$Status == "80%Coat",]%>%
#df_data[df_data$`Cell` == 23 | df_data$`Cell` == 25 | df_data$`Cell` == 33,] %>%
group_by(`CulturedDate`,`Condition`,`Status`,`SpheroidDensity`) %>%
summarise(
count = n(`day5Ratio`,na.rm = TRUE),
#    count = sum(!is.na(`day5Ratio`),na.rm = TRUE),
mean = mean(`day5Ratio`, na.rm = TRUE),
sd = sd(`day5Ratio`, na.rm = TRUE),
median = median(`day5Ratio`, na.rm = TRUE),
IQR = IQR(`day5Ratio`, na.rm = TRUE),
se = sd(`day5Ratio`, na.rm = TRUE)/sqrt(count)
)
Day5Matrix <-   df_data[df_data$CulturedDate <=11 & df_data$SpheroidDensity <= 1000 & df_data$Condition == "Spheroid" &
#                         df_data$Status != "Contaminated"&
(df_data$Status == "CompressedWithCell" | df_data$Status == "UncompressedWithCell"),]%>%
#| df_data$Status == "20%Coat" | df_data$Status == "80%Coat",]%>%
#df_data[df_data$`Cell` == 23 | df_data$`Cell` == 25 | df_data$`Cell` == 33,] %>%
group_by(`CulturedDate`,`Condition`,`Status`,`SpheroidDensity`) %>%
summarise(
count = n(),
#    count = sum(!is.na(`day5Ratio`),na.rm = TRUE),
mean = mean(`day5Ratio`, na.rm = TRUE),
sd = sd(`day5Ratio`, na.rm = TRUE),
median = median(`day5Ratio`, na.rm = TRUE),
IQR = IQR(`day5Ratio`, na.rm = TRUE),
se = sd(`day5Ratio`, na.rm = TRUE)/sqrt(count)
)
Day5Matrix
Day5Matrix <-   df_data[df_data$CulturedDate <=11 & df_data$SpheroidDensity <= 1000 & df_data$Condition == "Spheroid" &
#                         df_data$Status != "Contaminated"&
(df_data$Status == "CompressedWithCell" | df_data$Status == "UncompressedWithCell"),]%>%
#| df_data$Status == "20%Coat" | df_data$Status == "80%Coat",]%>%
#df_data[df_data$`Cell` == 23 | df_data$`Cell` == 25 | df_data$`Cell` == 33,] %>%
group_by(`CulturedDate`,`Condition`,`Status`,`SpheroidDensity`) %>%
summarise(
count = sum(!is.na(`day5Ratio`),na.rm = TRUE),
mean = mean(`day5Ratio`, na.rm = TRUE),
sd = sd(`day5Ratio`, na.rm = TRUE),
median = median(`day5Ratio`, na.rm = TRUE),
IQR = IQR(`day5Ratio`, na.rm = TRUE),
se = sd(`day5Ratio`, na.rm = TRUE)/sqrt(count)
)
Day5Matrix
Day5Matrix <-   df_data[df_data$CulturedDate <=11 & df_data$SpheroidDensity <= 1000 & df_data$Condition == "Spheroid" &
#                         df_data$Status != "Contaminated"&
(df_data$Status == "CompressedWithCell" | df_data$Status == "UncompressedWithCell"),]%>%
#| df_data$Status == "20%Coat" | df_data$Status == "80%Coat",]%>%
#df_data[df_data$`Cell` == 23 | df_data$`Cell` == 25 | df_data$`Cell` == 33,] %>%
group_by(`CulturedDate`,`Status`) %>%
summarise(
count = sum(!is.na(`day5Ratio`),na.rm = TRUE),
mean = mean(`day5Ratio`, na.rm = TRUE),
sd = sd(`day5Ratio`, na.rm = TRUE),
median = median(`day5Ratio`, na.rm = TRUE),
IQR = IQR(`day5Ratio`, na.rm = TRUE),
se = sd(`day5Ratio`, na.rm = TRUE)/sqrt(count)
)
Day5Matrix
Day5Matrix <-   df_data[df_data$CulturedDate <=11 & df_data$SpheroidDensity <= 1000 & df_data$Condition == "Spheroid" &
#                         df_data$Status != "Contaminated"&
(df_data$Status == "CompressedWithCell" | df_data$Status == "UncompressedWithCell"),]%>%
#| df_data$Status == "20%Coat" | df_data$Status == "80%Coat",]%>%
#df_data[df_data$`Cell` == 23 | df_data$`Cell` == 25 | df_data$`Cell` == 33,] %>%
group_by(`CulturedDate`) %>%
summarise(
count = sum(!is.na(`day5Ratio`),na.rm = TRUE),
mean = mean(`day5Ratio`, na.rm = TRUE),
sd = sd(`day5Ratio`, na.rm = TRUE),
median = median(`day5Ratio`, na.rm = TRUE),
IQR = IQR(`day5Ratio`, na.rm = TRUE),
se = sd(`day5Ratio`, na.rm = TRUE)/sqrt(count)
)
Day5Matrix
Day5Matrix <-   df_data[df_data$CulturedDate <=11 & df_data$SpheroidDensity <= 1000 & df_data$Condition == "Spheroid" &
#                         df_data$Status != "Contaminated"&
(df_data$Status == "CompressedWithCell" | df_data$Status == "UncompressedWithCell"),]%>%
#| df_data$Status == "20%Coat" | df_data$Status == "80%Coat",]%>%
#df_data[df_data$`Cell` == 23 | df_data$`Cell` == 25 | df_data$`Cell` == 33,] %>%
group_by(`CulturedDate`,`Condition`,`Status`,`SpheroidDensity`) %>%
summarise(
count = sum(!is.na(`day5Ratio`),na.rm = TRUE),
mean = mean(`day5Ratio`, na.rm = TRUE),
sd = sd(`day5Ratio`, na.rm = TRUE),
median = median(`day5Ratio`, na.rm = TRUE),
IQR = IQR(`day5Ratio`, na.rm = TRUE),
se = sd(`day5Ratio`, na.rm = TRUE)/sqrt(count)
)
Day5Matrix
Day5Matrix <-   df_data[df_data$CulturedDate <=11 & df_data$SpheroidDensity <= 1000 & df_data$Condition == "Spheroid" & !(is.na(df_data$day5Ratio))
#                         df_data$Status != "Contaminated"&
(df_data$Status == "CompressedWithCell" | df_data$Status == "UncompressedWithCell"),]%>%
#| df_data$Status == "20%Coat" | df_data$Status == "80%Coat",]%>%
#df_data[df_data$`Cell` == 23 | df_data$`Cell` == 25 | df_data$`Cell` == 33,] %>%
group_by(`CulturedDate`,`Condition`,`Status`,`SpheroidDensity`) %>%
summarise(
count = sum(!is.na(`day5Ratio`),na.rm = TRUE),
mean = mean(`day5Ratio`, na.rm = TRUE),
sd = sd(`day5Ratio`, na.rm = TRUE),
median = median(`day5Ratio`, na.rm = TRUE),
IQR = IQR(`day5Ratio`, na.rm = TRUE),
se = sd(`day5Ratio`, na.rm = TRUE)/sqrt(count)
)
Day5Matrix <-   df_data[df_data$CulturedDate <=11 & df_data$SpheroidDensity <= 1000 & df_data$Condition == "Spheroid" & !(is.na(df_data$day5Ratio)) &
#                         df_data$Status != "Contaminated"&
(df_data$Status == "CompressedWithCell" | df_data$Status == "UncompressedWithCell"),]%>%
#| df_data$Status == "20%Coat" | df_data$Status == "80%Coat",]%>%
#df_data[df_data$`Cell` == 23 | df_data$`Cell` == 25 | df_data$`Cell` == 33,] %>%
group_by(`CulturedDate`,`Condition`,`Status`,`SpheroidDensity`) %>%
summarise(
count = sum(!is.na(`day5Ratio`),na.rm = TRUE),
mean = mean(`day5Ratio`, na.rm = TRUE),
sd = sd(`day5Ratio`, na.rm = TRUE),
median = median(`day5Ratio`, na.rm = TRUE),
IQR = IQR(`day5Ratio`, na.rm = TRUE),
se = sd(`day5Ratio`, na.rm = TRUE)/sqrt(count)
)
Day5Matrix
Day5Matrix <-   df_data[df_data$CulturedDate ==11 & df_data$SpheroidDensity <= 1000 & df_data$Condition == "Spheroid" &
#                         df_data$Status != "Contaminated"&
(df_data$Status == "CompressedWithCell" | df_data$Status == "UncompressedWithCell"),]%>%
#| df_data$Status == "20%Coat" | df_data$Status == "80%Coat",]%>%
#df_data[df_data$`Cell` == 23 | df_data$`Cell` == 25 | df_data$`Cell` == 33,] %>%
group_by(`CulturedDate`,`Condition`,`Status`,`SpheroidDensity`) %>%
summarise(
count = sum(!is.na(`day5Ratio`),na.rm = TRUE),
mean = mean(`day5Ratio`, na.rm = TRUE),
sd = sd(`day5Ratio`, na.rm = TRUE),
median = median(`day5Ratio`, na.rm = TRUE),
IQR = IQR(`day5Ratio`, na.rm = TRUE),
se = sd(`day5Ratio`, na.rm = TRUE)/sqrt(count)
)
Day5Matrix
Day5Matrix <-   df_data[df_data$CulturedDate <=11 & df_data$SpheroidDensity <= 1000 & df_data$Condition == "Spheroid" &
#                         df_data$Status != "Contaminated"&
(df_data$Status == "CompressedWithCell" | df_data$Status == "UncompressedWithCell"),]%>%
#| df_data$Status == "20%Coat" | df_data$Status == "80%Coat",]%>%
#df_data[df_data$`Cell` == 23 | df_data$`Cell` == 25 | df_data$`Cell` == 33,] %>%
group_by(`CulturedDate`,`Condition`,`Status`,`SpheroidDensity`) %>%
summarise(
count = sum(!is.na(`day5Ratio`),na.rm = TRUE),
mean = mean(`day5Ratio`, na.rm = TRUE),
sd = sd(`day5Ratio`, na.rm = TRUE),
median = median(`day5Ratio`, na.rm = TRUE),
IQR = IQR(`day5Ratio`, na.rm = TRUE),
se = sd(`day5Ratio`, na.rm = TRUE)/sqrt(count)
)
Day5Matrix
Day5Matrix <-   df_data[df_data$CulturedDate <=11 & df_data$SpheroidDensity == 1000 & df_data$Condition == "Spheroid" &
#                         df_data$Status != "Contaminated"&
(df_data$Status == "CompressedWithCell" | df_data$Status == "UncompressedWithCell"),]%>%
#| df_data$Status == "20%Coat" | df_data$Status == "80%Coat",]%>%
#df_data[df_data$`Cell` == 23 | df_data$`Cell` == 25 | df_data$`Cell` == 33,] %>%
group_by(`CulturedDate`,`Condition`,`Status`,`SpheroidDensity`) %>%
summarise(
count = sum(!is.na(`day5Ratio`),na.rm = TRUE),
mean = mean(`day5Ratio`, na.rm = TRUE),
sd = sd(`day5Ratio`, na.rm = TRUE),
median = median(`day5Ratio`, na.rm = TRUE),
IQR = IQR(`day5Ratio`, na.rm = TRUE),
se = sd(`day5Ratio`, na.rm = TRUE)/sqrt(count)
)
Day5Matrix
ggplot(Day5Matrix,aes(x=CulturedDate, y=mean, group=SpheroidDensity, shape=Status,color=Status))+
geom_point(mapping = aes(x = CulturedDate, y = mean), data = Day5Matrix, size=5)+
geom_line(mapping = aes(x = CulturedDate, y = mean, group=Status), data = Day5Matrix, size=1.5)+
geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width=0.2,size=2)+
#  geom_text(data = AllMatrix, aes(x = CulturedDate, y = mean, label=paste(round(mean,digits = 0))),parse = TRUE, vjust=-2, size=4,fontface = "bold")+
#  facet_wrap(~SpheroidDensity, labeller = "label_both")+
#  theme_classic()+
theme_bw()+
border(size = 3)+
labs( y="Growth ratio \n (Diameter/initial Diameter)", x="Cultured Date (days)",
#        title = "Spheroid Expansion"
)+
#  scale_y_continuous(breaks = seq(0,2000,200))+
#  scale_x_continuous(labels=my_xlab, breaks = seq(5,11,1))+
#  scale_color_discrete(name = "ECM ",label=c("20%Coat","80%Coat","Compressed","Uncompressed",""))+
#  scale_shape_discrete(name = "ECM ",label=c("20%Coat","80%Coat","Compressed","Uncompressed",""))+
theme(
#        axis.line = element_line(size = 2, color = "black"),
axis.ticks = element_line(size = 2, color = "black"),
axis.ticks.length=unit(0.4, "cm"),
#        prism.ticks.length.y = unit(0.12, "cm"),
axis.text = element_text(size = 24, color = "black", face = "bold"),
axis.title = element_text(size = 20, face = "bold"),
legend.position = "top",
legend.text = element_text(size=14, face = "bold"),
legend.title = element_text(size=14, face = "bold"),
#        axis.line.y = element_blank(),
#        axis.text.y = element_blank(),
#        axis.ticks.y = element_blank(),
#        axis.title.y = element_blank(),
#        axis.title.x = element_text(hjust = 1),
#        axis.title.x = element_blank(),
text = element_text(family ="A"),
plot.title = element_text(size = 25, face = "bold"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
easy_center_title()
channel <- odbcDriverConnect(PATH)
DRIVERINFO <- "Driver={Microsoft Access Driver (*.mdb, *.accdb)};"
MDBPATH <- "E:/OneDrive/文件/TMU-DESKTOP-SF2LD60-Surface-Go-Surface-Go.accdb"
PATH <- paste0(DRIVERINFO, "DBQ=", MDBPATH)
channel <- odbcDriverConnect(PATH)
df_spheroid <- sqlQuery(channel,"SELECT * FROM Spheroid, Cell WHERE Spheroid.Cell=Cell.識別碼;", stringsAsFactors = FALSE)
df_sample <- sqlQuery(channel,"SELECT * FROM Sample, Collagen_Membrane_Preparation WHERE Sample.Scaffolds=Collagen_Membrane_Preparation.識別碼;")
df_data <- merge(df_spheroid,df_sample,by.x="識別碼.1",by.y = "Cell",all.x = "TRUE")
df_spheroid
#df_data <- subset.data.frame(df_spheroid, `Cell` == 34)
#[df_data$`Cell` == 25,]
SynthesisMatrix <- df_data[df_data$`Cell` == 185,] %>%
group_by(`CulturedDate`,`SpheroidDensity`,`Ingredient`,`Status`,`Condition`,`Cell`,`Ancestor`,`Group Name.x`) %>%
summarise(
count = sum(!is.na(`Diameter`)),
mean = mean(`Diameter`, na.rm = TRUE),
sd = sd(`Diameter`, na.rm = TRUE),
median = median(`Diameter`, na.rm = TRUE),
IQR = IQR(`Diameter`, na.rm = TRUE),
se = sd(`Diameter`, na.rm = TRUE)/sqrt(count)
)
SynthesisMatrix
#df_data_single <- subset.data.frame(df_data, `Cell` == 33)
df_data_single <- subset.data.frame(df_data, `Cell` == 185)
ggplot(df_data_single,aes(x=CulturedDate, y=Diameter), ylim=c(0,1000))+
geom_point(color='gray')+
geom_line(aes(group=Spheroid),linetype="dotted", color='white')+
geom_point(
mapping = aes(x = CulturedDate, y = mean), data = SynthesisMatrix, colour='red', size=3)+
geom_line(mapping = aes(x = CulturedDate, y = mean), data = SynthesisMatrix,colour='red', size=2)+
geom_text(data = SynthesisMatrix, aes(x = CulturedDate, y = mean, label=paste(round(mean,digits = 0))),
colour='pink',parse = TRUE, vjust=-1, size=6)+
theme_classic()+
labs(title = paste("1000 cells/200 μl Spheroid of ",SynthesisMatrix$`Group Name.x`[1]), y="Diameter (μm)", x="Cultured Date (days)")+
theme(text = element_text(size=19),
panel.background = element_rect(fill = 'black'),
plot.background=element_rect(fill = "black",colour = "black"),
axis.title = element_text(colour = "white"),
axis.line = element_line(colour = "white",size = 1),
axis.text = element_text(color = "white"),
axis.ticks = element_line(colour ="white", size = 2),
plot.title = element_text(size=20,colour = "white"),
plot.subtitle = element_text(size = 14, colour = "white"))+
easy_center_title()
close(channel)
ggplot(Day5Matrix,aes(x=CulturedDate, y=mean, group=SpheroidDensity, shape=Status,color=Status))+
geom_point(mapping = aes(x = CulturedDate, y = mean), data = Day5Matrix, size=5)+
geom_line(mapping = aes(x = CulturedDate, y = mean, group=Status), data = Day5Matrix, size=1.5)+
geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width=0.2,size=2)+
#  geom_text(data = AllMatrix, aes(x = CulturedDate, y = mean, label=paste(round(mean,digits = 0))),parse = TRUE, vjust=-2, size=4,fontface = "bold")+
#  facet_wrap(~SpheroidDensity, labeller = "label_both")+
#  theme_classic()+
theme_bw()+
border(size = 3)+
labs( y="Growth ratio \n (Diameter/initial Diameter)", x="Cultured Date (days)",
#        title = "Spheroid Expansion"
)+
#  scale_y_continuous(breaks = seq(0,2000,200))+
#  scale_x_continuous(labels=my_xlab, breaks = seq(5,11,1))+
#  scale_color_discrete(name = "ECM ",label=c("20%Coat","80%Coat","Compressed","Uncompressed",""))+
#  scale_shape_discrete(name = "ECM ",label=c("20%Coat","80%Coat","Compressed","Uncompressed",""))+
theme(
#        axis.line = element_line(size = 2, color = "black"),
axis.ticks = element_line(size = 2, color = "black"),
axis.ticks.length=unit(0.4, "cm"),
#        prism.ticks.length.y = unit(0.12, "cm"),
axis.text = element_text(size = 24, color = "black", face = "bold"),
axis.title = element_text(size = 20, face = "bold"),
legend.position = "top",
legend.text = element_text(size=14, face = "bold"),
legend.title = element_text(size=14, face = "bold"),
#        axis.line.y = element_blank(),
#        axis.text.y = element_blank(),
#        axis.ticks.y = element_blank(),
#        axis.title.y = element_blank(),
#        axis.title.x = element_text(hjust = 1),
#        axis.title.x = element_blank(),
text = element_text(family ="A"),
plot.title = element_text(size = 25, face = "bold"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
easy_center_title()
days <- c(1,2,3,4,5,6,7)
days
my_xlab <- paste(days)
ggplot(Day5Matrix,aes(x=CulturedDate, y=mean, group=SpheroidDensity, shape=Status,color=Status))+
geom_point(mapping = aes(x = CulturedDate, y = mean), data = Day5Matrix, size=5)+
geom_line(mapping = aes(x = CulturedDate, y = mean, group=Status), data = Day5Matrix, size=1.5)+
geom_errorbar(aes(ymin=mean-se, ymax=mean+se), width=0.2,size=2)+
#  geom_text(data = AllMatrix, aes(x = CulturedDate, y = mean, label=paste(round(mean,digits = 0))),parse = TRUE, vjust=-2, size=4,fontface = "bold")+
#  facet_wrap(~SpheroidDensity, labeller = "label_both")+
#  theme_classic()+
theme_bw()+
border(size = 3)+
labs( y="Growth ratio \n (Diameter/initial Diameter)", x="Cultured Date (days)",
#        title = "Spheroid Expansion"
)+
#  scale_y_continuous(breaks = seq(0,2000,200))+
scale_x_continuous(labels=my_xlab, breaks = seq(5,11,1))+
#  scale_color_discrete(name = "ECM ",label=c("20%Coat","80%Coat","Compressed","Uncompressed",""))+
#  scale_shape_discrete(name = "ECM ",label=c("20%Coat","80%Coat","Compressed","Uncompressed",""))+
theme(
#        axis.line = element_line(size = 2, color = "black"),
axis.ticks = element_line(size = 2, color = "black"),
axis.ticks.length=unit(0.4, "cm"),
#        prism.ticks.length.y = unit(0.12, "cm"),
axis.text = element_text(size = 24, color = "black", face = "bold"),
axis.title = element_text(size = 20, face = "bold"),
legend.position = "top",
legend.text = element_text(size=14, face = "bold"),
legend.title = element_text(size=14, face = "bold"),
#        axis.line.y = element_blank(),
#        axis.text.y = element_blank(),
#        axis.ticks.y = element_blank(),
#        axis.title.y = element_blank(),
#        axis.title.x = element_text(hjust = 1),
#        axis.title.x = element_blank(),
text = element_text(family ="A"),
plot.title = element_text(size = 25, face = "bold"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
easy_center_title()
close(channel)
